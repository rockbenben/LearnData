"use strict";(self.webpackChunklearn_data=self.webpackChunklearn_data||[]).push([[9513],{2789:(s,i)=>{i.A=(s,i)=>{const a=s.__vccOpts||s;for(const[s,n]of i)a[s]=n;return a}},5223:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>e,data:()=>t});var n=a(7829);const l=[(0,n.Fv)('<p>AutoHotkey 是 Windows 平台下开源的热键脚本语言。AHK 学习门槛不高，初期可以通过脚本录制来完成，我通过 AHK 热键启动、定时判断、改键盘等多种自动化操作，推荐学习制作你的专属自动化脚本。</p><ul><li><a href="https://wyagd001.github.io/v2/docs" target="_blank" rel="noopener noreferrer">AutoHotkey 中文说明</a>：<a href="https://wyagd001.github.io/v2/docs/KeyList.htm" target="_blank" rel="noopener noreferrer">按键 Key 名列表</a>，<a href="https://wyagd001.github.io/v2/docs/Variables.htm#BuiltIn" target="_blank" rel="noopener noreferrer">AHK 环境变量</a>。</li><li>脚本录制/功能编辑：<a href="https://www.macrocreator.com/download/" target="_blank" rel="noopener noreferrer">Pulover&#39;s Macro Creator</a>，<a href="https://github.com/papple23g/ahkcompiler" target="_blank" rel="noopener noreferrer">AutoHotkey 語法產生器 (線上網站)</a>。</li></ul><table><thead><tr><th>符号</th><th>作用</th></tr></thead><tbody><tr><td>#</td><td>Win 键</td></tr><tr><td>!</td><td>Alt 键</td></tr><tr><td>^</td><td>Ctrl 键</td></tr><tr><td>+</td><td>Shift 键</td></tr><tr><td>`</td><td>转义字符，参考<a href="https://wyagd001.github.io/v2/docs/misc/EscapeChar.htm" target="_blank" rel="noopener noreferrer">转义序列</a></td></tr><tr><td>;</td><td>代表注释内容，不影响函数</td></tr><tr><td>::</td><td>(两个英文冒号)，代表分隔</td></tr></tbody></table><p><strong>注意事项</strong>：</p><ul><li>AHK 中<strong>不区分大小写</strong>，即 run 和 RUN 没有区别。</li><li>非热键情况，添加 <code>return</code>，脚本全部停止。</li><li>脚本需考虑，你是想要在<strong>全局</strong>还是<strong>局部</strong>中激活动作。</li></ul><h2 id="常用方法" tabindex="-1"><a class="header-anchor" href="#常用方法"><span>常用方法</span></a></h2><h3 id="托盘图标" tabindex="-1"><a class="header-anchor" href="#托盘图标"><span>托盘图标</span></a></h3><p>自定义图标可使用 ico 或 png，不支持 svg 格式。</p><p>托盘图标设置命令为 <code>Menu, Tray, Icon, %A_WorkingDir%\\dock_panel.png</code>。<code>%A_WorkingDir%</code> 代表脚本所在目录。</p><p>如果是设置 exe 程序图标，则使用 <a href="https://github.com/AutoHotkey/Ahk2Exe/releases" target="_blank" rel="noopener noreferrer">Ahk2Exe</a> 工具手动转换。</p><h3 id="执行-powershell" tabindex="-1"><a class="header-anchor" href="#执行-powershell"><span>执行 PowerShell</span></a></h3><p>系统级别的操作可以通过 <a href="https://learn.microsoft.com/zh-cn/powershell/scripting/learn/ps101/01-getting-started" target="_blank" rel="noopener noreferrer">PowerShell</a> 来实现。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"># Run, powershell.exe -NoExit -Command &amp;{命令}, 目录</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Run,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> powershell.exe</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -NoExit</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -Command</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> &amp;{npm version patch}, D:\\Backup</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="问题" tabindex="-1"><a class="header-anchor" href="#问题"><span>问题</span></a></h2><h3 id="激发热键后按键未释放" tabindex="-1"><a class="header-anchor" href="#激发热键后按键未释放"><span>激发热键后按键未释放</span></a></h3><p><code>Send, ^!+w</code> 指代热键 <code>Ctrl+Alt+Shift+W</code>，有时辅助热键未正确释放，会导致激发热键后输入有问题。</p><p>函数结尾加一行 <code>Send, {Ctrl up}{Alt up}{Shift up}</code> 即可解决该问题。</p><h3 id="隐藏在托盘程序无法监测" tabindex="-1"><a class="header-anchor" href="#隐藏在托盘程序无法监测"><span>隐藏在托盘程序无法监测</span></a></h3><p><code>WinExist</code> 只能查看签订程序，对于后台或托盘程序，可以用 Process 命令来检查是否存在指定程序的 PID。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">晚上8点停止录屏，并精简视频</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">A_Hour</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ==</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 20</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Stop_Record</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ==</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">){ ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">如果小时等于20点</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    Stop_Record:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">=1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">设置停止录屏变量为1</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    Process,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Exist,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> bdcam.exe</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">监测隐藏程序</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    NewPID</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ErrorLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">由于</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ErrorLevel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 会经常发生改变,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 所以要立即保存这个值.</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> NewPID</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> {</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">如果存在录屏工具，则继续</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Send,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ^+!{F8}</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">晚上8点后，停止录屏</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Sleep,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">等待5分钟</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">重命名文件</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        FileMove,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\B</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ackup</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\L</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ibraries</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\D</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">esktop</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">A_YYYY%-%A_MM%-%A_DD%</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.mp4,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\B</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ackup</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\L</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ibraries</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\D</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">esktop</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\%</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">A_YYYY%-%A_MM%-%A_DD%.mp4</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Sleep,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">桌面打开终端，执行</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> dvr-scan</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 命令</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Run,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PowerShell.exe</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -NoExit</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -Command</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> &amp;{dvr-scan -i %A_YYYY%-%A_MM%-%A_DD%.mp4 -o %A_YYYY%-%A_MM%-%A_DD%_Scanned.avi}, D:\\Backup\\Libraries\\Desktop</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="命令中的按键未执行" tabindex="-1"><a class="header-anchor" href="#命令中的按键未执行"><span>命令中的按键未执行</span></a></h3><p>如果 AutoHotkey 脚本中模拟了按键，窗口中却并未执行，则尝试用管理员权限执行脚本。</p><p>低权限的窗口/进程不能发送消息到高权限窗口。比如 Quicker 窗口的权限高，普通启动的 AutoHotkey 脚本无法对 Quicker 输入模拟键，需要管理员权限。</p><h3 id="管理员权限运行脚本" tabindex="-1"><a class="header-anchor" href="#管理员权限运行脚本"><span>管理员权限运行脚本</span></a></h3><p>对于可执行文件，命令 <code>Run *RunAs</code> 相当于右键菜单的「以管理员权限运行」命令。</p><p>右键单击脚本的快捷方式，选择「属性」&gt;「高级」，勾选「用管理员身份运行」，只能用于手动开启，开机启动会忽略带管理器的启动项。</p><p>如果<strong>管理员密码为空</strong>，则参考 <a href="http://www.ujiaoshou.com/xtjc/155215500.html" target="_blank" rel="noopener noreferrer">Win10 添加开机启动项管理员权限运行如何设置</a>，在系统的任务计划程序添加管理员自启动。如果想避免启动报错，建议将启动触发器从「开机」改成「登录」，增加延迟 1 分钟，勾选「最高管理员权限」。设置后，脚本中的打开命令都将使用管理员权限执行。</p><p>如果<strong>管理员有设密码</strong>，则可使用下列命令，用管理员权限打开脚本。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">RunAs,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Administrator,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PassWD</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Run,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> %A_ScriptDir%</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">.ahk</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">RunAs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">恢复为普通权限</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="常用函数" tabindex="-1"><a class="header-anchor" href="#常用函数"><span>常用函数</span></a></h2><h3 id="命令-run-msgbox-send" tabindex="-1"><a class="header-anchor" href="#命令-run-msgbox-send"><span>命令：run, msgbox, send</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 运行程序或者文档或其他</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">!</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">n::run</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> notepad</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">便捷呼出程序，「notepad」是「运行」对话框中的命令之一，所以不用完整路径</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Run,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> %A_WorkingDir%</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\x</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">x.lnk</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">启用当前目录中的文件</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Run,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> chrome.exe</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://newzone.top/</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">指定浏览器打开链接。</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Run,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> %A_ProgramFiles%</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\S</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ome</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Application</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\A</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">pp.exe,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> %A_ProgramFiles%</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\S</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ome</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Application</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">有些程序需要在它们自己的目录下运行。</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Run,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;%A_ProgramFiles%\\Google\\Chrome\\Application\\chrome_proxy.exe --profile-directory=Default --app-id=xxxxxxxx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">打开</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Chrome</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 浏览器的内部应用，修改</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> app-id</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 即可</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Msgbox：显示带两个按钮的对话框</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (是 </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">和</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 否</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) 对话框中可加内容</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Msgbox，你好吗？</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">显示「你好吗？」的对话框</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Send：在当前窗口输入文本内容</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> how</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> you？</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">在当前窗口输入</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> how</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> you？</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="局部变量-ifwinactive" tabindex="-1"><a class="header-anchor" href="#局部变量-ifwinactive"><span>局部变量：IFwinactive</span></a></h3><p>注意：同样<strong>不区分大小写</strong>。比如 ifwinactive 等等。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;#IFwinactive（指定窗口）（热键或热字串）</span></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#IFwinactive 新建文本文档.txt - 记事本 ; 在*新建文本文档.txt - 记事本*这个指定窗口下，窗口标题的前半段符合即可</span></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#q:: ;按下 win 键和 q 键</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Notepad</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">激活打开记事本这个动作</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="热键、热字串" tabindex="-1"><a class="header-anchor" href="#热键、热字串"><span>热键、热字串</span></a></h2><h3 id="热键-按键-1-按键-2" tabindex="-1"><a class="header-anchor" href="#热键-按键-1-按键-2"><span>热键：(按键 1)(按键 2)</span></a></h3><p>当按下特定的按键，或者按键顺序，或者按键组合时，激活某个或者某系列动作。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#q:: ;按下 win 键和 q 键时激活运行记事本这个动作。</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Notepad</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 为</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> AHK</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 中一个命令，相当于</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> C</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 语言中的关键字或者说是函数。还有</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> msgbox</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 等等。</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">return</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 为返回值，在存在多个热键时需使用，不然热键中会起冲突。</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">q</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">n::</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">按下</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> q</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 和</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n，自定义按键：</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">按键</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)&amp;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">按键</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)&amp;</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&amp;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">按键</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> n</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">，用来连接任何两个或多个按键组合成一个新的按键。</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> notepad</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">激活打开记事本这个动作。</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="热字串-被替换内容-替换内容" tabindex="-1"><a class="header-anchor" href="#热字串-被替换内容-替换内容"><span>热字串：(被替换内容)::(替换内容)</span></a></h3><p>扩展或者说自动替换文本，当然也可以映射任何脚本动作。</p><p>自动替换：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:hay::how</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> you?</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">当输入</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> hay</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 时自动替换为</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> how</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> are</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> you？</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:nh::你好</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">当输入</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> nh</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 时自动替换为你好</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:/mail::gmail@gmail.com</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">键入/mail</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 后，再加空格、或</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tab、或回车，就可以触发缩写</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:/fk::轩先生这会子肯定在忙，请骚后。thx。祝君：天天开心，日日欣悦。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>热字串映射脚本：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:np:</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Notepad</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">当输入</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> np</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 加空格时激活运行记事本这个动作。</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">return</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:nh:</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 你好。</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">在当前窗口输入你好。</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">return</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:h:</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 欢迎光临！</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">只要输入</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> h，然后回车/TAB/空格就自动把</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> h</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 替换为欢迎光临！</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">*:w::欢迎你再次光临！</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">     ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">自动替换，不需要输入空格来触发替换</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">:hehe:</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">                 ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">替换支持换行文字，需要用括号？</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">老兄！</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">好久不见！</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>键入热字串后，再加<strong>空格</strong>、或 <strong>tab</strong>、或<strong>回车</strong>，就可以触发缩写。</p><h2 id="ahk-使用样例" tabindex="-1"><a class="header-anchor" href="#ahk-使用样例"><span>AHK 使用样例</span></a></h2><h3 id="神速激活-打开-隐藏程序" tabindex="-1"><a class="header-anchor" href="#神速激活-打开-隐藏程序"><span>神速激活/打开/隐藏程序</span></a></h3><p><code>Win+C</code>激活 Chrome 状态切换：Chrome 没打开时 --&gt; 打开；打开没激活状态时候 --&gt; 激活；打开处在激活状态时候 --&gt; 隐藏。<sup class="footnote-ref"><a href="#footnote1">[1]</a><a class="footnote-anchor" id="footnote-ref1"></a></sup></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#c::</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">IfWinNotExist</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ahk_class</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Chrome_WidgetWin_1</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    Run</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;C:</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Users</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Administrator</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">AppData</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Local</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Google</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Chrome</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Application</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">chrome.exe&quot;</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    WinActivate</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Else</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> IfWinNotActive</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ahk_class</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Chrome_WidgetWin_1</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    WinActivate</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Else</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    WinMinimize</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="一键运行-关闭脚本的循环" tabindex="-1"><a class="header-anchor" href="#一键运行-关闭脚本的循环"><span>一键运行/关闭脚本的循环</span></a></h3><p>按 F2 一键运行/关闭脚本的循环，空格可暂停/继续脚本。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7F848E;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">#maxThreadsPerHotkey, 2 ;让热键能同时有运行/关闭作用，否则键击会被忽略</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setKeyDelay,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 50,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 50</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">键击默认休眠</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">setMouseDelay,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 50</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">键击默认休眠</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">stop:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">=0</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">F2一键运行/关闭脚本的循环</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">$f2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">::</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    stop:</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">=!stop</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    while</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">stop</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        ;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">激活</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> excel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 窗口「工作簿」获取数值，然后激活</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> chrome</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 窗口执行命令，完成后进入循环。</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        WinActivate,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 工作簿</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Sleep,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 333</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Send,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> {Down}</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Sleep,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Send,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> {Control</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Down}{c}{Control</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Up}</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Sleep,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        WinActivate,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 捧场</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Google</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Chrome</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Sleep,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 333</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Send,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> {Control</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Down}{v}{Control</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Up}</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Sleep,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Send,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> {Enter}</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        Sleep,</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 100</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">return</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">如果需要暂停，可在脚本后加这段代码，按</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 空格键</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 就暂停，再按空格键继续运行。</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">space::pause</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="监测进程是否运行" tabindex="-1"><a class="header-anchor" href="#监测进程是否运行"><span>监测进程是否运行</span></a></h3><p>监测应用是否有运行，如果没运行则执行启动热键。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Process,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Exist,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> PicGo.exe</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">NewPID</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :=</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ErrorLevel</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">由于</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ErrorLevel</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 会经常发生改变，所以要立即保存值。</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> NewPID</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    run</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> C:</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Program</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Files</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">PicGo</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\\\\</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">PicGo.exe</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    sleep</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 3000</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    Send,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> {Shift</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Down}{Control</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Down}{p}{Control</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Up}{Shift</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Up}</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    Send,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> {Shift</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Down}{Control</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Down}{p}{Control</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Up}{Shift</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Up}</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">return</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="输入法状态影响字符输出" tabindex="-1"><a class="header-anchor" href="#输入法状态影响字符输出"><span>输入法状态影响字符输出</span></a></h3><p>在脚本中，调用函数<code>SendText()</code>输出文字，不受输入法状态。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;;;;;;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">新版独立小程序，可以避免输入法状态影响中文或英文字符的热键输出</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;;;;;;;</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">来源链接：</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">&lt;https://segmentfault.com/a/1190000017029464&gt;</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">SendText(var_string</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">){</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    local</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    SendInput</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> {text}%var_string%</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">    return</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="大写键改为-enter" tabindex="-1"><a class="header-anchor" href="#大写键改为-enter"><span>大写键改为 Enter</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> CapsLock</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> LeftEnter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">CapsLock</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Alt</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> CapsLock</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">$CapsLock</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">::Enter</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">LAlt</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> &amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">Capslock::SetCapsLockState,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> %</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> GetKeyState</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">&quot;CapsLock&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;T&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">?</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;Off&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;On&quot;</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">!</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">u::Send</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ^c</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> !{tab}</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ^v</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p><a href="https://segmentfault.com/a/1190000004611125" target="_blank" rel="noopener noreferrer">Win 下最爱效率利器:AutoHotKey</a> <a href="#footnote-ref1" class="footnote-backref">↩︎</a></p></li></ol></section>',63)],h={},e=(0,a(2789).A)(h,[["render",function(s,i){return(0,n.uX)(),(0,n.CE)("div",null,l)}]]),t=JSON.parse('{"path":"/code/AutoHotkey.html","title":"AutoHotkey","lang":"zh-CN","frontmatter":{"article":false,"title":"AutoHotkey","icon":"fa6-brands:autoprefixer","order":4,"description":"AutoHotkey 是 Windows 平台下开源的热键脚本语言。AHK 学习门槛不高，初期可以通过脚本录制来完成，我通过 AHK 热键启动、定时判断、改键盘等多种自动化操作，推荐学习制作你的专属自动化脚本。 AutoHotkey 中文说明：按键 Key 名列表，AHK 环境变量。 脚本录制/功能编辑：Pulover\'s Macro Creator，...","head":[["meta",{"property":"og:url","content":"https://newzone.top/code/AutoHotkey.html"}],["meta",{"property":"og:site_name","content":"LearnData 开源笔记"}],["meta",{"property":"og:title","content":"AutoHotkey"}],["meta",{"property":"og:description","content":"AutoHotkey 是 Windows 平台下开源的热键脚本语言。AHK 学习门槛不高，初期可以通过脚本录制来完成，我通过 AHK 热键启动、定时判断、改键盘等多种自动化操作，推荐学习制作你的专属自动化脚本。 AutoHotkey 中文说明：按键 Key 名列表，AHK 环境变量。 脚本录制/功能编辑：Pulover\'s Macro Creator，..."}],["meta",{"property":"og:type","content":"website"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-18T07:06:22.000Z"}],["meta",{"property":"article:author","content":"LearnData"}],["meta",{"property":"article:modified_time","content":"2024-08-18T07:06:22.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"WebPage\\",\\"name\\":\\"AutoHotkey\\",\\"description\\":\\"AutoHotkey 是 Windows 平台下开源的热键脚本语言。AHK 学习门槛不高，初期可以通过脚本录制来完成，我通过 AHK 热键启动、定时判断、改键盘等多种自动化操作，推荐学习制作你的专属自动化脚本。 AutoHotkey 中文说明：按键 Key 名列表，AHK 环境变量。 脚本录制/功能编辑：Pulover\'s Macro Creator，...\\"}"]]},"headers":[{"level":2,"title":"常用方法","slug":"常用方法","link":"#常用方法","children":[{"level":3,"title":"托盘图标","slug":"托盘图标","link":"#托盘图标","children":[]},{"level":3,"title":"执行 PowerShell","slug":"执行-powershell","link":"#执行-powershell","children":[]}]},{"level":2,"title":"问题","slug":"问题","link":"#问题","children":[{"level":3,"title":"激发热键后按键未释放","slug":"激发热键后按键未释放","link":"#激发热键后按键未释放","children":[]},{"level":3,"title":"隐藏在托盘程序无法监测","slug":"隐藏在托盘程序无法监测","link":"#隐藏在托盘程序无法监测","children":[]},{"level":3,"title":"命令中的按键未执行","slug":"命令中的按键未执行","link":"#命令中的按键未执行","children":[]},{"level":3,"title":"管理员权限运行脚本","slug":"管理员权限运行脚本","link":"#管理员权限运行脚本","children":[]}]},{"level":2,"title":"常用函数","slug":"常用函数","link":"#常用函数","children":[{"level":3,"title":"命令：run, msgbox, send","slug":"命令-run-msgbox-send","link":"#命令-run-msgbox-send","children":[]},{"level":3,"title":"局部变量：IFwinactive","slug":"局部变量-ifwinactive","link":"#局部变量-ifwinactive","children":[]}]},{"level":2,"title":"热键、热字串","slug":"热键、热字串","link":"#热键、热字串","children":[{"level":3,"title":"热键：(按键 1)(按键 2)","slug":"热键-按键-1-按键-2","link":"#热键-按键-1-按键-2","children":[]},{"level":3,"title":"热字串：(被替换内容)::(替换内容)","slug":"热字串-被替换内容-替换内容","link":"#热字串-被替换内容-替换内容","children":[]}]},{"level":2,"title":"AHK 使用样例","slug":"ahk-使用样例","link":"#ahk-使用样例","children":[{"level":3,"title":"神速激活/打开/隐藏程序","slug":"神速激活-打开-隐藏程序","link":"#神速激活-打开-隐藏程序","children":[]},{"level":3,"title":"一键运行/关闭脚本的循环","slug":"一键运行-关闭脚本的循环","link":"#一键运行-关闭脚本的循环","children":[]},{"level":3,"title":"监测进程是否运行","slug":"监测进程是否运行","link":"#监测进程是否运行","children":[]},{"level":3,"title":"输入法状态影响字符输出","slug":"输入法状态影响字符输出","link":"#输入法状态影响字符输出","children":[]},{"level":3,"title":"大写键改为 Enter","slug":"大写键改为-enter","link":"#大写键改为-enter","children":[]}]}],"git":{"createdTime":1658511538000,"updatedTime":1723964782000,"contributors":[{"name":"rockbenben","email":"qingwhat@gmail.com","commits":9}]},"readingTime":{"minutes":7.23,"words":2168},"filePathRelative":"code/AutoHotkey.md","localizedDate":"2022年7月22日","excerpt":"<p>AutoHotkey 是 Windows 平台下开源的热键脚本语言。AHK 学习门槛不高，初期可以通过脚本录制来完成，我通过 AHK 热键启动、定时判断、改键盘等多种自动化操作，推荐学习制作你的专属自动化脚本。</p>\\n<ul>\\n<li><a href=\\"https://wyagd001.github.io/v2/docs\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">AutoHotkey 中文说明</a>：<a href=\\"https://wyagd001.github.io/v2/docs/KeyList.htm\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">按键 Key 名列表</a>，<a href=\\"https://wyagd001.github.io/v2/docs/Variables.htm#BuiltIn\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">AHK 环境变量</a>。</li>\\n<li>脚本录制/功能编辑：<a href=\\"https://www.macrocreator.com/download/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Pulover\'s Macro Creator</a>，<a href=\\"https://github.com/papple23g/ahkcompiler\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">AutoHotkey 語法產生器 (線上網站)</a>。</li>\\n</ul>","autoDesc":true}')}}]);
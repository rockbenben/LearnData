"use strict";(self.webpackChunklearn_data=self.webpackChunklearn_data||[]).push([[7317],{5720:(e,t,n)=>{n.d(t,{pageviewCount:()=>c});const a={"Content-Type":"application/json"},r=e=>`${e.replace(/\/?$/,"/")}api/`,o=(e,t="")=>{if("object"==typeof e&&e.errno)throw new TypeError(`${t} failed with ${e.errno}: ${e.errmsg}`);return e},l=e=>{const t=((e="")=>e.replace(/\/$/u,""))(e);return(e=>/^(https?:)?\/\//.test(e))(t)?t:`https://${t}`},s=e=>{"AbortError"!==e.name&&console.error(e.message)},i=e=>e.dataset.path||null,p=(e,t)=>{t.forEach(((t,n)=>{const a=e[n].time;"number"==typeof a&&(t.innerText=a.toString())}))},c=({serverURL:e,path:t=window.location.pathname,selector:n=".waline-pageview-count",update:c=!0,lang:h=navigator.language})=>{const g=new AbortController,u=Array.from(document.querySelectorAll(n)),d=e=>{const n=i(e);return null!==n&&t!==n},f=n=>(({serverURL:e,lang:t,paths:n,signal:a})=>(({serverURL:e,lang:t,paths:n,type:a,signal:l})=>fetch(`${r(e)}article?path=${encodeURIComponent(n.join(","))}&type=${encodeURIComponent(a.join(","))}&lang=${t}`,{signal:l}).then((e=>e.json())).then((e=>o(e,"Get counter").data)))({serverURL:e,lang:t,paths:n,type:["time"],signal:a}))({serverURL:l(e),paths:n.map((e=>i(e)||t)),lang:h,signal:g.signal}).then((e=>p(e,n))).catch(s);if(c){const n=u.filter((e=>!d(e))),s=u.filter(d);(e=>(({serverURL:e,lang:t,path:n,type:l,action:s})=>fetch(`${r(e)}article?lang=${t}`,{method:"POST",headers:a,body:JSON.stringify({path:n,type:l,action:s})}).then((e=>e.json())).then((e=>o(e,"Update counter").data)))({...e,type:"time",action:"inc"}))({serverURL:l(e),path:t,lang:h}).then((e=>p(e,n))),s.length&&f(s)}else f(u);return g.abort.bind(g)}}}]);
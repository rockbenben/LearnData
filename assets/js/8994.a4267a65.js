"use strict";(self.webpackChunklearn_data=self.webpackChunklearn_data||[]).push([[8994],{2126:(t,s,e)=>{e.d(s,{R:()=>a});var i=e(5242);class a{constructor(t){this.Ca=t}Bb(){(0,i.i)(this.ca)&&this.Oe()}ra(){(0,i.a)(this.ca)&&window.cancelAnimationFrame(this.ca),this.ca=void 0}Oe(){this.ca=window.requestAnimationFrame((()=>{(0,i.i)(this.ca)||(this.Ca(),this.Oe())}))}}},8994:(t,s,e)=>{e.r(s),e.d(s,{GoogleCastProvider:()=>l});var i=e(5242),a=e(2186),h=e(2126),r=e(3493),n=e(8332);class c{constructor(t){this.Ul=new chrome.cast.media.MediaInfo(t.src,t.type)}build(){return this.Ul}Xl(t){return t.includes("live")?this.Ul.streamType=chrome.cast.media.StreamType.LIVE:this.Ul.streamType=chrome.cast.media.StreamType.BUFFERED,this}Yl(t){return this.Ul.tracks=t.map(this.Il),this}Zl(t,s){return this.Ul.metadata=new chrome.cast.media.GenericMediaMetadata,this.Ul.metadata.title=t,this.Ul.metadata.images=[{url:s}],this}Il(t,s){const e=new chrome.cast.media.Track(s,chrome.cast.media.TrackType.TEXT);return e.name=t.label,e.trackContentId=t.src,e.trackContentType="text/vtt",e.language=t.language,e.subtype=t.kind.toUpperCase(),e}}const o=chrome.cast.media.TrackType.TEXT,m=chrome.cast.media.TrackType.AUDIO;class d{constructor(t,s,e){this.xm=t,this.b=s,this.zm=e}Hm(){const t=this.Km.bind(this);(0,i.l)(this.b.audioTracks,"change",t),(0,i.l)(this.b.textTracks,"mode-change",t),(0,i.e)(this.Lm.bind(this))}wm(){return this.b.$state.textTracks().filter((t=>t.src&&"vtt"===t.type))}Cm(){return this.b.$state.audioTracks()}Wl(t){const s=this.xm.mediaInfo?.tracks??[];return t?s.filter((s=>s.type===t)):s}Dm(){const t=[],s=this.Cm().find((t=>t.selected)),e=this.wm().filter((t=>"showing"===t.mode));if(s){const e=this.Wl(m),i=this.ym(e,s);i&&t.push(i.trackId)}if(e?.length){const s=this.Wl(o);if(s.length)for(const i of e){const e=this.ym(s,i);e&&t.push(e.trackId)}}return t}Lm(){const t=this.wm();if(!this.xm.isMediaLoaded)return;const s=this.Wl(o);for(const e of t)if(!this.ym(s,e)){(0,i.O)((()=>this.zm?.()));break}}Mm(t){if(!this.xm.isMediaLoaded)return;const s=this.Cm(),e=this.wm(),i=this.Wl(m),a=this.Wl(o);for(const e of i){if(this.Em(s,e))continue;const i={id:e.trackId.toString(),label:e.name,language:e.language,kind:e.subtype??"main",selected:!1};this.b.audioTracks[r.L.oa](i,t)}for(const s of a){if(this.Em(e,s))continue;const i={id:s.trackId.toString(),src:s.trackContentId,label:s.name,language:s.language,kind:s.subtype.toLowerCase()};this.b.textTracks.add(i,t)}}Km(t){if(!this.xm.isMediaLoaded)return;const s=this.Dm(),e=new chrome.cast.media.EditTracksInfoRequest(s);this.Jm(e).catch((t=>{}))}Jm(t){const s=(0,n.f)();return new Promise(((e,i)=>s?.editTracksInfo(t,e,i)))}Em(t,s){return t.find((t=>this.Fm(t,s)))}ym(t,s){return t.find((t=>this.Fm(s,t)))}Fm(t,s){return s.name===t.label&&s.language===t.language&&s.subtype.toLowerCase()===t.kind.toLowerCase()}}class l{constructor(t,s){this.aa=t,this.b=s,this.$$PROVIDER_TYPE="GOOGLE_CAST",this.scope=(0,i.x)(),this.V=null,this.mc="disconnected",this.Va=0,this.Fa=0,this.Ga=new a.T(0,0),this.Hb=new a.T(0,0),this.Da=new h.R(this.bd.bind(this)),this.vm=null,this.Am=!1,this.yb=new d(this.aa,this.b,this.zm.bind(this))}get c(){return this.b.delegate.c}get type(){return"google-cast"}get currentSrc(){return this.V}get player(){return this.aa}get cast(){return(0,n.g)()}get session(){return(0,n.a)()}get media(){return(0,n.f)()}get hasActiveSession(){return(0,n.j)(this.V)}setup(){this.sm(),this.tm(),this.yb.Hm(),this.c("provider-setup",this)}sm(){(0,n.l)(cast.framework.CastContextEventType.CAST_STATE_CHANGED,this.qm.bind(this))}tm(){const t=cast.framework.RemotePlayerEventType,s={[t.IS_CONNECTED_CHANGED]:this.qm,[t.IS_MEDIA_LOADED_CHANGED]:this.Jl,[t.CAN_CONTROL_VOLUME_CHANGED]:this.em,[t.CAN_SEEK_CHANGED]:this.fm,[t.DURATION_CHANGED]:this.wg,[t.IS_MUTED_CHANGED]:this.ab,[t.VOLUME_LEVEL_CHANGED]:this.ab,[t.IS_PAUSED_CHANGED]:this.jm,[t.LIVE_SEEKABLE_RANGE_CHANGED]:this.ic,[t.PLAYER_STATE_CHANGED]:this.km};this.dm=s;const e=this.lm.bind(this);for(const t of(0,i.P)(s))this.aa.controller.addEventListener(t,e);(0,i.o)((()=>{for(const t of(0,i.P)(s))this.aa.controller.removeEventListener(t,e)}))}async play(){(this.aa.isPaused||this.Am)&&(this.Am?await this.Gm(!1,0):this.aa.controller?.playOrPause())}async pause(){this.aa.isPaused||this.aa.controller?.playOrPause()}getMediaStatus(t){return new Promise(((s,e)=>{this.media?.getStatus(t,s,e)}))}setMuted(t){(t&&!this.aa.isMuted||!t&&this.aa.isMuted)&&this.aa.controller?.muteOrUnmute()}setCurrentTime(t){this.aa.currentTime=t,this.c("seeking",t),this.aa.controller?.seek()}setVolume(t){this.aa.volumeLevel=t,this.aa.controller?.setVolumeLevel()}async loadSource(t){if(this.vm?.src!==t&&(this.vm=null),(0,n.j)(t))return this.um(),void(this.V=t);this.c("load-start");const s=this.am(t),e=await this.session.loadMedia(s);if(e)return this.V=null,void this.c("error",Error((0,n.c)(e)));this.V=t}destroy(){this.H(),this.rm()}H(){this.vm||(this.Fa=0,this.Ga=new a.T(0,0),this.Hb=new a.T(0,0)),this.Da.ra(),this.Va=0,this.vm=null}um(){const t=new i.D("resume-session",{detail:this.session});this.Jl(t);const{muted:s,volume:e,remotePlaybackInfo:a}=this.b.$state,h=a();this.setCurrentTime(Math.max(this.aa.currentTime,h?.savedState?.currentTime??0)),this.setMuted(s()),this.setVolume(e()),!1===h?.savedState?.paused&&this.play()}rm(){this.cast.endCurrentSession(!0);const{remotePlaybackLoader:t}=this.b.$state;t.set(null)}Ml(){this.b.$state.remotePlaybackInfo.set({savedState:{paused:this.aa.isPaused,currentTime:this.aa.currentTime}}),this.rm()}bd(){this.im()}lm(t){this.dm[t.type].call(this,t)}qm(t){const s=this.cast.getCastState(),e=s===cast.framework.CastState.CONNECTED?"connected":s===cast.framework.CastState.CONNECTING?"connecting":"disconnected";if(this.mc===e)return;const i={type:"google-cast",state:e},a=this.Vl(t);this.mc=e,this.c("remote-playback-change",i,a),"disconnected"===e&&this.Ml()}Jl(t){if(!this.aa.isMediaLoaded)return;const s=(0,i.u)(this.b.$state.source);Promise.resolve().then((()=>{if(s!==(0,i.u)(this.b.$state.source)||!this.aa.isMediaLoaded)return;this.H();const e=this.aa.duration;this.Hb=new a.T(0,e);const h={provider:this,duration:e,buffered:this.Ga,seekable:this.gm()},r=this.Vl(t);this.c("loaded-metadata",void 0,r),this.c("loaded-data",void 0,r),this.c("can-play",h,r),this.em(),this.fm(t);const{volume:n,muted:c}=this.b.$state;this.setVolume(n()),this.setMuted(c()),this.Da.Bb(),this.yb.Mm(r),this.yb.Km(r)}))}em(){this.b.$state.canSetVolume.set(this.aa.canControlVolume)}fm(t){const s=this.Vl(t);this.c("stream-type-change",this.mm(),s)}mm(){const t=this.aa.mediaInfo?.streamType;return t===chrome.cast.media.StreamType.LIVE?this.aa.canSeek?"live:dvr":"live":"on-demand"}im(){if(this.vm)return;const t=this.aa.currentTime;if(t===this.Va)return;const s=this.Fa,e={currentTime:t,played:this.cm(t)};this.c("time-update",e),t>s&&this.ic(),this.b.$state.seeking()&&this.c("seeked",t),this.Va=t}cm(t){return this.Fa>=t?this.Ga:this.Ga=new a.T(0,this.Fa=t)}wg(t){if(!this.aa.isMediaLoaded||this.vm)return;const s=this.aa.duration,e=this.Vl(t);this.Hb=new a.T(0,s),this.c("duration-change",s,e)}ab(t){if(!this.aa.isMediaLoaded)return;const s={muted:this.aa.isMuted,volume:this.aa.volumeLevel},e=this.Vl(t);this.c("volume-change",s,e)}jm(t){const s=this.Vl(t);this.aa.isPaused?this.c("pause",void 0,s):this.c("play",void 0,s)}ic(t){const s={seekable:this.gm(),buffered:this.Ga},e=t?this.Vl(t):void 0;this.c("progress",s,e)}km(t){const s=this.aa.playerState,e=chrome.cast.media.PlayerState;if(this.Am=s===e.IDLE,s===e.PAUSED)return;const i=this.Vl(t);switch(s){case e.PLAYING:this.c("playing",void 0,i);break;case e.BUFFERING:this.c("waiting",void 0,i);break;case e.IDLE:this.Da.ra(),this.c("pause"),this.c("end")}}gm(){return this.aa.liveSeekableRange?new a.T(this.aa.liveSeekableRange.start,this.aa.liveSeekableRange.end):this.Hb}Vl(t){return t instanceof Event?t:new i.D(t.type,{detail:t})}Dl(t){const{streamType:s,title:e,poster:i}=this.b.$state;return new c(t).Zl(e(),i()).Xl(s()).Yl(this.yb.wm()).build()}am(t){const s=this.Dl(t),e=new chrome.cast.media.LoadRequest(s),i=this.b.$state.remotePlaybackInfo();return e.autoplay=!1===(this.vm?.paused??i?.savedState?.paused),e.currentTime=this.vm?.time??i?.savedState?.currentTime??0,e}async Gm(t,s){const e=(0,i.u)(this.b.$state.source);this.vm={src:e,paused:t,time:s},await this.loadSource(e)}zm(){this.Gm(this.aa.isPaused,this.aa.currentTime).catch((t=>{}))}}}}]);
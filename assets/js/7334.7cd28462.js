"use strict";(self.webpackChunklearn_data=self.webpackChunklearn_data||[]).push([[7334],{7334:(e,t,s)=>{s.r(t),s.d(t,{SSAParser:()=>p,default:()=>b});var a=s(5881);const r=/^Format:[\s\t]*/,i=/^Style:[\s\t]*/,n=/^Dialogue:[\s\t]*/,l=/[\s\t]*,[\s\t]*/,c=/\{[^}]+\}/g,h=/\\N/g,o=/^\[(.*)[\s\t]?Styles\]$/,u=/^\[(.*)[\s\t]?Events\]$/;class p{f;P=0;a=null;j=[];k=[];O=null;d;Q={};async init(e){this.f=e,e.errors&&(this.d=(await s.e(7886).then(s.bind(s,7886))).ParseErrorBuilder)}parse(e,t){if(this.P)switch(this.P){case 1:if(""===e)this.P=0;else if(i.test(e))if(this.O){const t=e.replace(i,"").split(l);this.T(t)}else this.e(this.d?.N("Style",t));else r.test(e)?this.O=e.replace(r,"").split(l):u.test(e)&&(this.O=null,this.P=2);break;case 2:if(""===e)this.R();else if(n.test(e))if(this.R(),this.O){const s=e.replace(n,"").split(l),a=this.U(s,t);a&&(this.a=a)}else this.e(this.d?.N("Dialogue",t));else this.a?this.a.text+="\n"+e.replace(c,"").replace(h,"\n"):r.test(e)?this.O=e.replace(r,"").split(l):o.test(e)?(this.O=null,this.P=1):u.test(e)&&(this.O=null)}else""===e||(o.test(e)?(this.O=null,this.P=1):u.test(e)&&(this.O=null,this.P=2))}done(){return{metadata:{},cues:this.j,regions:[],errors:this.k}}R(){this.a&&(this.j.push(this.a),this.f.onCue?.(this.a),this.a=null)}T(e){let t,s,a,r,i="Default",n={},l="center",c="bottom",h=1.2,o=3,u=[];for(let p=0;p<this.O.length;p++){const d=this.O[p],b=e[p];switch(d){case"Name":i=b;break;case"Fontname":n["font-family"]=b;break;case"Fontsize":n["font-size"]=`calc(${b} / var(--overlay-height))`;break;case"PrimaryColour":const e=f(b);e&&(n["--cue-color"]=e);break;case"BorderStyle":o=parseInt(b,10);break;case"BackColour":r=f(b);break;case"OutlineColour":const p=f(b);p&&(a=p);break;case"Bold":parseInt(b)&&(n["font-weight"]="bold");break;case"Italic":parseInt(b)&&(n["font-style"]="italic");break;case"Underline":parseInt(b)&&(n["text-decoration"]="underline");break;case"StrikeOut":parseInt(b)&&(n["text-decoration"]="line-through");break;case"Spacing":n["letter-spacing"]=b+"px";break;case"AlphaLevel":n.opacity=parseFloat(b);break;case"ScaleX":u.push(`scaleX(${parseFloat(b)/100})`);break;case"ScaleY":u.push(`scaleY(${parseFloat(b)/100})`);break;case"Angle":u.push(`rotate(${b}deg)`);break;case"Shadow":h=1.2*parseInt(b,10);break;case"MarginL":n["--cue-width"]="auto",n["--cue-left"]=parseFloat(b)+"px";break;case"MarginR":n["--cue-width"]="auto",n["--cue-right"]=parseFloat(b)+"px";break;case"MarginV":s=parseFloat(b);break;case"Outline":t=parseInt(b,10);break;case"Alignment":const d=parseInt(b,10);switch(d>=4&&(c=d>=7?"top":"center"),d%3){case 1:l="start";break;case 2:l="center";break;case 3:l="end"}}}if(n.S=c,n["--cue-white-space"]="normal",n["--cue-line-height"]="normal",n["--cue-text-align"]=l,"center"===c?(n["--cue-top"]="50%",u.push("translateY(-50%)")):n[`--cue-${c}`]=(s||0)+"px",1===o&&(n["--cue-padding-y"]="0"),(1===o||r)&&(n["--cue-bg-color"]=1===o?"none":r),3===o&&a&&(n["--cue-outline"]=`${t}px solid ${a}`),1===o&&"number"==typeof t){const e=r??"#000";n["--cue-text-shadow"]=[a&&d(1.2*t,1.2*h,a),a?d(t*(t/2),h*(t/2),e):d(t,h,e)].filter(Boolean).join(", ")}u.length&&(n["--cue-transform"]=u.join(" ")),this.Q[i]=n}U(e,t){const s=this.V(e),r=this.o(s.Start,s.End,t);if(!r)return;const i=new a.b(r[0],r[1],""),n={...this.Q[s.Style]||{}},l=s.Name?`<v ${s.Name}>`:"",o=n.S,u=s.MarginL&&parseFloat(s.MarginL),p=s.MarginR&&parseFloat(s.MarginR),f=s.MarginV&&parseFloat(s.MarginV);return u&&(n["--cue-width"]="auto",n["--cue-left"]=u+"px"),p&&(n["--cue-width"]="auto",n["--cue-right"]=p+"px"),f&&"center"!==o&&(n[`--cue-${o}`]=f+"px"),i.text=l+e.slice(this.O.length-1).join(", ").replace(c,"").replace(h,"\n"),delete n.S,Object.keys(n).length&&(i.style=n),i}V(e){const t={};for(let s=0;s<this.O.length;s++)t[this.O[s]]=e[s];return t}o(e,t,s){const r=(0,a.p)(e),i=(0,a.p)(t);if(null!==r&&null!==i&&i>r)return[r,i];null===r&&this.e(this.d?.q(e,s)),null===i&&this.e(this.d?.r(t,s)),null!=r&&null!==i&&i>r&&this.e(this.d?.s(r,i,s))}e(e){if(e){if(this.k.push(e),this.f.strict)throw this.f.cancel(),e;this.f.onError?.(e)}}}function f(e){const t=parseInt(e.replace("&H",""),16);return t>=0?"rgba("+[255&t,t>>8&255,t>>16&255,(t>>24&255^255)/255].join(",")+")":null}function d(e,t,s){const a=Math.ceil(2*Math.PI*e);let r="";for(let i=0;i<a;i++){const n=2*Math.PI*i/a;r+=e*Math.cos(n)+"px "+t*Math.sin(n)+"px 0 "+s+(i==a-1?"":",")}return r}function b(){return new p}}}]);